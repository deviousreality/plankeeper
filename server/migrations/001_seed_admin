import { db } from '~/server/utils/db';

// Replace with your actual admin user seed data
const adminUser = {
  username: process.env['ADMIN_USERNAME'],
  password: process.env['ADMIN_PASSWORD'],
  email: process.env['ADMIN_EMAIL'],
};

export function up() {
  const userCount = db.prepare('SELECT COUNT(*) as count FROM users').get().count;
  if (userCount === 0) {
    db.prepare('INSERT INTO users (username, password, email) VALUES (?, ?, ?)').run(
      adminUser.username,
      adminUser.password,
      adminUser.email
    );
    console.log('Seeded admin user.');
  } else {
    console.log('Users already exist, skipping admin seed.');
  }
}

export function down() {
  // Optionally remove the seeded admin user
  db.prepare('DELETE FROM users WHERE username = ?').run(adminUser.username);
  console.log('Removed seeded admin user.');
}
